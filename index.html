<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html>
  <body>
    <title>Cancer Bar charts</title>
    <style>
      .d3-tip {
      line-height: 1;
      padding: 12px;
      color: #000;
      border-radius: 2px;
      font-size: 13px;
      margin-top: 0px;
            }
       .d3-tipTwo {
      line-height: 1;
      padding: 12px;
      color: #000;
      border-radius: 2px;
      font-size: 13px;
            /*margin-top: 130px;*/
      }
       .d3-tipThree {
      line-height: 1;
      padding: 12px;
      color: #000;
      border-radius: 2px;
      font-size: 13px;
            /*margin-top: 300px;*/
      }
      .d3-tipFour {
      line-height: 1;
      padding: 12px;
      color: #000;
      border-radius: 2px;
      font-size: 13px;
            /*margin-top: 500px;*/
      }
      .bar rect {
      fill: steelblue;
      shape-rendering: crispEdges;
      }
      .bar rect:hover{
      fill: rgba(0,0,0,.8);
      }
      .axis path, .axis line {
      fill: none;
      stroke: #000;
      shape-rendering: crispEdges;
      }
      text{
        font-size: 12px;
      }
        #tiptable tr{
    /*margin-bottom: 1px;*/
    /*padding-left: 5px;*/
    /*padding-right: 5px;*/
    /*border-bottom: 1px solid #777;*/
  }
    #tiptable tr td{
    background: #fff;
    /*margin-bottom: 1px;*/
    /*margin-right: 1px;*/
    /*border-right: 1px solid #ccc;*/
  }
  h3{
    text-align: center;
    width: 600px;
    padding: 0px;
    margin: 0px;
    font-size: 16px;
  }
    .d3-tooltip{
    background: #ccc;
    border-radius: 5px;
    padding: 8px;
    border: .6px solid black;
    margin-top: 50px;
  }
  .charts{
    width: 600px;
    float: left;
    margin-right: 20px;
  }
  #column1, #column3, #column5, #chart4{
    border: 2px solid #777;
    margin-bottom: 10px;
  }

table { border-collapse: collapse; 
background: #aaa;
}
tr { display: block; float: left; 
  margin-left: 0px;
  margin-right: 0px;
  padding-left: 0px;
  padding-right: 0px;
  }
th, td { display: block; 
  text-align: left;
  /*border: 1px solid black; */
  background: #fff; margin-bottom: 1px;
  padding: 5px;

}
.disease {
  fill: rgb(198, 226, 255);
}

.other {
  fill: rgb(50,50,50);
}

.wounds {
  fill: rgb(252,112,147);
}

    </style>
    <script src="js/jquery.2.1.1.min.js"></script>
    <script src="./js/script.js"></script>
    <script src="./js/d3.v4.js"></script>
    <script src="./js/d3.v4.tip.js"></script>
    <script>
    var globalData;
    var termsData;
    var allTermsList = [""];
    var allTermsListSplit;
    var termsWithFrequency;
    var avgP53Val;
    var avgCASVal;
    var avgRASVal;
    var finalHighVal=0;

        var lineColor = d3.scaleLinear()
                      .domain([0,100])
                      .range(['#00f', '#f00'])

        var tip1 = d3.tip()
      .attr('class', 'd3-tip d3-tooltip')
      .direction('e')
      .offset([0, 20])
      .html(function(d) {
         return '<table id="tiptable">' + '<tr><th> <b>chr</th><th> <b>start</th><th> <b>end</b> </th><th> <b>strand</b> </th><th> <b>symbol</b> </th><th> <b>length</b> </th><th> <b>P53KO-O1</b> </th><th> <b>P53KO-O2</b> </th><th> <b>p53KO-O-CAS1</b> </th><th> <b>p53KO-O-CAS2</b> </th><th> <b>p53KO-O-RAS1</b> </th><th> <b>p53KO-O-RAS2</b> </th><th> <b>WT-O1</b> </th><th> <b>WT-O2</b> </th></tr>' + d + "</table>";
    });

          var tip2 = d3.tip()
      .attr('class', 'd3-tipTwo d3-tooltip')
      .direction('e')
      .offset([0, 20])
      .html(function(d) {
         return '<table id="tiptable">' + '<tr><th> <b>chr</th><th> <b>start</th><th> <b>end</b> </th><th> <b>strand</b> </th><th> <b>symbol</b> </th><th> <b>length</b> </th><th> <b>P53KO-O1</b> </th><th> <b>P53KO-O2</b> </th><th> <b>p53KO-O-CAS1</b> </th><th> <b>p53KO-O-CAS2</b> </th><th> <b>p53KO-O-RAS1</b> </th><th> <b>p53KO-O-RAS2</b> </th><th> <b>WT-O1</b> </th><th> <b>WT-O2</b> </th></tr>' + d + "</table>";
    });

          var tip3 = d3.tip()
      .attr('class', 'd3-tipThree d3-tooltip')
      .direction('e')
      .offset([0, 20])
      .html(function(d) {
         return '<table id="tiptable">' + '<tr><th> <b>chr</th><th> <b>start</th><th> <b>end</b> </th><th> <b>strand</b> </th><th> <b>symbol</b> </th><th> <b>length</b> </th><th> <b>P53KO-O1</b> </th><th> <b>P53KO-O2</b> </th><th> <b>p53KO-O-CAS1</b> </th><th> <b>p53KO-O-CAS2</b> </th><th> <b>p53KO-O-RAS1</b> </th><th> <b>p53KO-O-RAS2</b> </th><th> <b>WT-O1</b> </th><th> <b>WT-O2</b> </th></tr>' + d + "</table>";
    });

          var tip4 = d3.tip()
      .attr('class', 'd3-tipFour d3-tooltip')
      .direction('e')
      .offset([0, 20])
      .html(function(d) {
         return '<table id="tiptable">' + '<tr><th> <b>chr</th><th> <b>start</th><th> <b>end</b> </th><th> <b>strand</b> </th><th> <b>symbol</b> </th><th> <b>length</b> </th><th> <b>P53KO-O1</b> </th><th> <b>P53KO-O2</b> </th><th> <b>p53KO-O-CAS1</b> </th><th> <b>p53KO-O-CAS2</b> </th><th> <b>p53KO-O-RAS1</b> </th><th> <b>p53KO-O-RAS2</b> </th><th> <b>WT-O1</b> </th><th> <b>WT-O2</b> </th></tr>' + d + "</table>";
    });

          var tip5 = d3.tip()
      .attr('class', 'd3-tipFour d3-tooltip')
      .direction('e')
      .offset([0, 20])
      .html(function(d) {
         return '<table id="tiptable">' + '<tr><th> <b>chr</th><th> <b>start</th><th> <b>end</b> </th><th> <b>strand</b> </th><th> <b>symbol</b> </th><th> <b>length</b> </th><th> <b>P53KO-O1</b> </th><th> <b>P53KO-O2</b> </th><th> <b>p53KO-O-CAS1</b> </th><th> <b>p53KO-O-CAS2</b> </th><th> <b>p53KO-O-RAS1</b> </th><th> <b>p53KO-O-RAS2</b> </th><th> <b>WT-O1</b> </th><th> <b>WT-O2</b> </th></tr>' + d + "</table>";
    });


function chartOne(data) {
 // console.log(data);
 var allData =data;
  var minVal = (d3.min(data, function(d) { return d.avgP53; }));
  var maxVal = (d3.max(data, function(d) { return d.avgP53; }));

  var width =  600;
  var height = 130;
 avgP53Val = d3.extent(data.map(function (d) {
        return (d.avgP53);
   }))
  avgCASVal = d3.extent(data.map(function (d) {
        return (d.avgRAS);
   }))
  if(avgCASVal[1]>avgP53Val)
    finalHighVal = avgCASVal[1];

 avgRASVal = d3.extent(data.map(function (d) {
        return (d.avgRAS);
   }))
 if(avgRASVal[1]>finalHighVal)
    finalHighVal = avgRASVal[1];

 colWTVal = d3.extent(data.map(function (d) {
        return (d.avgWT);
   }))
 if(colWTVal[1]>finalHighVal)
    finalHighVal = colWTVal[1];

  console.log(finalHighVal);


lineColor.domain([0, finalHighVal]);

    var x = d3.scaleLinear()
      .domain([0,1])
      .range([0, width-80]);
    
    var y = d3.scaleLinear()
      .domain([0, finalHighVal])
      .range([height, 0]);

    var xAxis = d3.axisBottom()
      .scale(x)
      .ticks(0)

    var yAxis = d3.axisLeft()
      .scale(y)
      .ticks(5)


    // put the graph in the "twitterViz" div
    var svg = d3.select("#column1").append("svg")
      .attr("width", width)
      .attr("height", height + 30)
      .append("g")
      .attr("transform", "translate(" + 70 + "," + 10 + ")");
var attrX = 1;
    svg.call(tip1);
    // set up the bars
    var bar = svg.selectAll(".bar")
      .data(data)
      .enter().append("rect")
      .attr("id", function(d, i){
          return "avgP53"+d.id;
      })
      .attr("x", function(d,i){
        return attrX+(i/2.05);
      })
      .attr("width", 2)
      .attr("y", function(d){
        return y(d.avgP53);
      })
      .attr("height", function(d) { return height - y(d.avgP53); })
      .attr("fill", function(d){
                    return lineColor(d.avgP53);
                })
      .on('mouseover', function(d){
        var tipContent = "";
        	tipContent = tipContent + '<tr><td>' + d.chr + "</td>" + '<td>' +d.start + '</td><td>' +d.end + '</td><td>' + d.strand +'</td><td>' +d.symbol +'</td><td>' +d.length + '</td><td>' + d.col1 + '</td><td>' +d.col2  + '</td><td>' +d.col3 + '</td><td>' +d.col4 + '</td><td>' +d.col5+ '</td><td>' +d.col6+ '</td><td>' +d.col7+ '</td><td>' +d.col8 + "</td></tr>";
          tip1.show(tipContent, this);
          // tip2.show(tipContent, this);
          // tip3.show(tipContent, this);
          // console.log(d)
          selectId = "#avgP53" + d.id;
          d3.select(selectId)
          .attr("fill", "#ff8707");
 
          selectId = "#avgCAS" + d.id;
          d3.select(selectId)
          .attr("fill", "#ff8707");
          
          selectId = "#avgRAS" + d.id;
          d3.select(selectId)
          .attr("fill", "#ff8707");

          selectId = "#avgWT" + d.id;
          d3.select(selectId)
          .attr("fill", "#ff8707");
      })
      .on('mouseout', function(d){
        tip1.hide();
        // tip2.hide();
        // tip3.hide();
       selectId = "#avgP53" + d.id;
          d3.select(selectId)
          .attr("fill", function(d){
            return lineColor(d.avgP53);
          })

          selectId = "#avgCAS" + d.id;
          d3.select(selectId)
          .attr("fill", function(d){
            return lineColor(d.avgCAS);
          })

          selectId = "#avgRAS" + d.id;
          d3.select(selectId)
          .attr("fill", function(d){
            return lineColor(d.avgRAS);
          })
          selectId = "#avgWT" + d.id;
          d3.select(selectId)
          .attr("fill", function(d){
            return lineColor(d.avgWT);
          })
      })
    // add the x axis and x-label
    svg.append("g")
      .attr("class", "x axis")
      .attr("transform", "translate(0," + height + ")")
      .call(xAxis)
      .selectAll("text")  
      .attr("x", "-50")
      .attr("transform", "rotate(-90)");
    svg.append("text")
      .attr("class", "xlabel")
      .attr("text-anchor", "middle")
      .attr("x", width / 2)
      .attr("y", 600)
      .text("");
    // add the y axis and y-label
    svg.append("g")
      .attr("class", "y axis")
      .attr("transform", "translate(0,0)")
      .call(yAxis);
    svg.append("text")
      .attr("class", "ylabel")
      .attr("y", 10) // x and y switched due to rotation
      .attr("x", 0 - (height / 2))
      .attr("dy", "1em")
      .attr("transform", "rotate(-90)")
      .style("text-anchor", "middle")
      .text("Value");
}

function chartTwo(data) {
 // console.log(data);

 
  var width =  600;
  var height = 130;
lineColor.domain([0, finalHighVal]);

    var x = d3.scaleLinear()
      .domain([0,1])
      .range([0, width-80]);
    
    var y = d3.scaleLinear()
      .domain([0, finalHighVal])
      .range([height, 0]);

    var xAxis = d3.axisBottom()
      .scale(x)
.ticks(0)

    var yAxis = d3.axisLeft()
      .scale(y)
      .ticks(5)
      
   
    // put the graph in the "twitterViz" div
    var svg = d3.select("#column3").append("svg")
      .attr("width", width)
      .attr("height", height+30)
      .append("g")
      .attr("transform", "translate(" + 70 + "," + 10 + ")");
var attrX = 1;
    svg.call(tip2);
    // set up the bars
    var bar = svg.selectAll(".bar")
      .data(data)
      .enter().append("rect")
      .attr("id", function(d, i){
          return "avgCAS"+d.id;
      })
      .attr("x", function(d,i){
        return attrX+ (i/2.05);
      })
      .attr("width", 2)
      .attr("y", function(d){
        return y(d.avgCAS);
      })
      .attr("height", function(d) { return height - y(d.avgCAS); })
        .attr("fill", function(d){
                    return lineColor(d.avgCAS);
                })
      .on('mouseover', function(d){
        var tipContent = "";
        	tipContent = tipContent + '<tr><td>' + d.chr + "</td>" + '<td>' +d.start + '</td><td>' +d.end + '</td><td>' + d.strand +'</td><td>' +d.symbol +'</td><td>' +d.length + '</td><td>' + d.col1 + '</td><td>' +d.col2  + '</td><td>' +d.col3 + '</td><td>' +d.col4 + '</td><td>' +d.col5+ '</td><td>' +d.col6+ '</td><td>' +d.col7+ '</td><td>' +d.col8 + "</td></tr>";
          // tip1.show(tipContent, this);
          tip2.show(tipContent, this);
          // tip3.show(tipContent, this);
          // console.log(d)
          selectId = "#avgP53" + d.id;
          d3.select(selectId)
          .attr("fill", "#ff8707");
 
          selectId = "#avgCAS" + d.id;
          d3.select(selectId)
          .attr("fill", "#ff8707");
          
          selectId = "#avgRAS" + d.id;
          d3.select(selectId)
          .attr("fill", "#ff8707");

          selectId = "#avgWT" + d.id;
          d3.select(selectId)
          .attr("fill", "#ff8707");
      })
      .on('mouseout', function(d){
        // tip1.hide();
        tip2.hide();
        // tip3.hide();
       selectId = "#avgP53" + d.id;
          d3.select(selectId)
          .attr("fill", function(d){
            return lineColor(d.avgP53);
          })

          selectId = "#avgCAS" + d.id;
          d3.select(selectId)
          .attr("fill", function(d){
            return lineColor(d.avgCAS);
          })

          selectId = "#avgRAS" + d.id;
          d3.select(selectId)
          .attr("fill", function(d){
            return lineColor(d.avgRAS);
          })
          selectId = "#avgWT" + d.id;
          d3.select(selectId)
          .attr("fill", function(d){
            return lineColor(d.avgWT);
          })
      })
    // add the x axis and x-label
    svg.append("g")
      .attr("class", "x axis")
      .attr("transform", "translate(0," + height + ")")
      .call(xAxis)
      .selectAll("text")  
      .attr("x", "-50")
      .attr("transform", "rotate(-90)");
    svg.append("text")
      .attr("class", "xlabel")
      .attr("text-anchor", "middle")
      .attr("x", width / 2)
      .attr("y", 600)
      .text("");
    // add the y axis and y-label
    svg.append("g")
      .attr("class", "y axis")
      .attr("transform", "translate(0,0)")
      .call(yAxis);
    svg.append("text")
      .attr("class", "ylabel")
      .attr("y", 10) // x and y switched due to rotation
      .attr("x", 0 - (height / 2))
      .attr("dy", "1em")
      .attr("transform", "rotate(-90)")
      .style("text-anchor", "middle")
      .text("Value");
}

function chartThree(data) {
 // console.log(data);

 
  var width =  600;
  var height = 130;
lineColor.domain([0, finalHighVal]);

    var x = d3.scaleLinear()
      .domain([0,1])
      .range([0, width-80]);
    
    var y = d3.scaleLinear()
      .domain([0, finalHighVal])
      .range([height, 0]);

    var xAxis = d3.axisBottom()
      .scale(x)
.ticks(0)

    var yAxis = d3.axisLeft()
      .scale(y)
      .ticks(5)
      
  
    // put the graph in the "twitterViz" div
    var svg = d3.select("#column5").append("svg")
      .attr("width", width)
      .attr("height", height+30)
      .append("g")
      .attr("transform", "translate(" + 70 + "," + 10 + ")");
var attrX = 1;
    svg.call(tip3);
    // set up the bars
    var bar = svg.selectAll(".bar")
      .data(data)
      .enter().append("rect")
      .attr("id", function(d, i){
          return "avgRAS"+d.id;
      })
      .attr("x", function(d,i){
        return attrX+ (i/2.05);
      })
      .attr("width", 2)
      .attr("y", function(d){
        return y(d.avgRAS);
      })
      .attr("height", function(d) { return height - y(d.avgRAS); })
      .attr("fill", function(d){
                    return lineColor(d.avgRAS);
                })
      .on('mouseover', function(d){
        var tipContent = "";
        	tipContent = tipContent + '<tr><td>' + d.chr + "</td>" + '<td>' +d.start + '</td><td>' +d.end + '</td><td>' + d.strand +'</td><td>' +d.symbol +'</td><td>' +d.length + '</td><td>' + d.col1 + '</td><td>' +d.col2  + '</td><td>' +d.col3 + '</td><td>' +d.col4 + '</td><td>' +d.col5+ '</td><td>' +d.col6+ '</td><td>' +d.col7+ '</td><td>' +d.col8 + "</td></tr>";
        
          // tip1.show(tipContent, this);
          // tip2.show(tipContent, this);
          tip3.show(tipContent, this);
          // console.log(d)
          selectId = "#avgP53" + d.id;
          d3.select(selectId)
          .attr("fill", "#ff8707");
 
          selectId = "#avgCAS" + d.id;
          d3.select(selectId)
          .attr("fill", "#ff8707");
          
          selectId = "#avgRAS" + d.id;
          d3.select(selectId)
          .attr("fill", "#ff8707");

          selectId = "#avgWT" + d.id;
          d3.select(selectId)
          .attr("fill", "#ff8707");
      })
      .on('mouseout', function(d){
        // tip1.hide();
        // tip2.hide();
        tip3.hide();
       selectId = "#avgP53" + d.id;
          d3.select(selectId)
          .attr("fill", function(d){
            return lineColor(d.avgP53);
          })

          selectId = "#avgCAS" + d.id;
          d3.select(selectId)
          .attr("fill", function(d){
            return lineColor(d.avgCAS);
          })

          selectId = "#avgRAS" + d.id;
          d3.select(selectId)
          .attr("fill", function(d){
            return lineColor(d.avgRAS);
          })
          selectId = "#avgWT" + d.id;
          d3.select(selectId)
          .attr("fill", function(d){
            return lineColor(d.avgWT);
          })
      })
    // add the x axis and x-label
    svg.append("g")
      .attr("class", "x axis")
      .attr("transform", "translate(0," + height + ")")
      .call(xAxis)
      .selectAll("text")  
      .attr("x", "-50")
      .attr("transform", "rotate(-90)");
    svg.append("text")
      .attr("class", "xlabel")
      .attr("text-anchor", "middle")
      .attr("x", width / 2)
      .attr("y", 600)
      .text("");
    // add the y axis and y-label
    svg.append("g")
      .attr("class", "y axis")
      .attr("transform", "translate(0,0)")
      .call(yAxis);
    svg.append("text")
      .attr("class", "ylabel")
      .attr("y", 10) // x and y switched due to rotation
      .attr("x", 0 - (height / 2))
      .attr("dy", "1em")
      .attr("transform", "rotate(-90)")
      .style("text-anchor", "middle")
      .text("Value");
}

function chartFour(data) {
 // console.log(data);

 
  var width =  600;
  var height = 130;
lineColor.domain([0, finalHighVal]);

    var x = d3.scaleLinear()
      .domain([0,1])
      .range([0, width-80]);
    
    var y = d3.scaleLinear()
      .domain([0, finalHighVal])
      .range([height, 0]);

    var xAxis = d3.axisBottom()
      .scale(x)
.ticks(0)

    var yAxis = d3.axisLeft()
      .scale(y)
      .ticks(5)
      
  
    // put the graph in the "twitterViz" div
    var svg = d3.select("#chart4").append("svg")
      .attr("width", width)
      .attr("height", height+30)
      .append("g")
      .attr("transform", "translate(" + 70 + "," + 10 + ")");
var attrX = 1;
    svg.call(tip4);
    // set up the bars
    var bar = svg.selectAll(".bar")
      .data(data)
      .enter().append("rect")
      .attr("id", function(d, i){
          return "avgWT"+d.id;
      })
      .attr("x", function(d,i){
        return attrX+ (i/2.05);
      })
      .attr("width", 2)
      .attr("y", function(d){
        // console.log(d);
        return y(d.avgWT);
      })
      .attr("height", function(d) { return height - y(d.avgWT); })
      .attr("fill", function(d){
                    return lineColor(d.avgWT);
                })
      .on('mouseover', function(d){
        var tipContent = "";
        	tipContent = tipContent + '<tr><td>' + d.chr + "</td>" + '<td>' +d.start + '</td><td>' +d.end + '</td><td>' + d.strand +'</td><td>' +d.symbol +'</td><td>' +d.length + '</td><td>' + d.col1 + '</td><td>' +d.col2  + '</td><td>' +d.col3 + '</td><td>' +d.col4 + '</td><td>' +d.col5+ '</td><td>' +d.col6+ '</td><td>' +d.col7+ '</td><td>' +d.col8 + "</td></tr>";
        
          // tip1.show(tipContent, this);
          // tip2.show(tipContent, this);
          tip4.show(tipContent, this);
          // console.log(d)
          selectId = "#avgP53" + d.id;
          d3.select(selectId)
          .attr("fill", "#ff8707");

          console.log(selectId);
 
          selectId = "#avgCAS" + d.id;
          d3.select(selectId)
          .attr("fill", "#ff8707");
          
          selectId = "#avgRAS" + d.id;
          d3.select(selectId)
          .attr("fill", "#ff8707");

          selectId = "#avgWT" + d.id;
          d3.select(selectId)
          .attr("fill", "#ff8707");
      })
      .on('mouseout', function(d){
        // tip1.hide();
        // tip2.hide();
        tip4.hide();
       selectId = "#avgP53" + d.id;
          d3.select(selectId)
          .attr("fill", function(d){
            return lineColor(d.avgP53);
          })

          selectId = "#avgCAS" + d.id;
          d3.select(selectId)
          .attr("fill", function(d){
            return lineColor(d.avgCAS);
          })

          selectId = "#avgRAS" + d.id;
          d3.select(selectId)
          .attr("fill", function(d){
            return lineColor(d.avgRAS);
          })
          selectId = "#avgWT" + d.id;
          d3.select(selectId)
          .attr("fill", function(d){
            return lineColor(d.avgWT);
          })
      })
    // add the x axis and x-label
    svg.append("g")
      .attr("class", "x axis")
      .attr("transform", "translate(0," + height + ")")
      .call(xAxis)
      .selectAll("text")  
      .attr("x", "-50")
      .attr("transform", "rotate(-90)");
    svg.append("text")
      .attr("class", "xlabel")
      .attr("text-anchor", "middle")
      .attr("x", width / 2)
      .attr("y", 600)
      .text("");
    // add the y axis and y-label
    svg.append("g")
      .attr("class", "y axis")
      .attr("transform", "translate(0,0)")
      .call(yAxis);
    svg.append("text")
      .attr("class", "ylabel")
      .attr("y", 10) // x and y switched due to rotation
      .attr("x", 0 - (height / 2))
      .attr("dy", "1em")
      .attr("transform", "rotate(-90)")
      .style("text-anchor", "middle")
      .text("Value");
}
function updateChartsAscending(){
    console.log("yes")
    globalData.sort(function(a, b) {
    return a.avgP53 - b.avgP53;
});
 d3.selectAll("svg").remove();
             chartOne(globalData);
             chartTwo(globalData);
             chartThree(globalData);
             chartFour(globalData);

}

function updateChartsDescending(){
    console.log("yes")
    globalData.sort(function(a, b) {
    return b.avgP53 - a.avgP53;
});
 d3.selectAll("svg").remove();
             chartOne(globalData);
             chartTwo(globalData);
             chartThree(globalData);
             chartFour(globalData);

}
function updateChartsReset(){
    console.log("yes")
    globalData.sort(function(a, b) {
    return a.id - b.id;
});
 d3.selectAll("svg").remove();
             chartOne(globalData);
             chartTwo(globalData);
             chartThree(globalData);
             chartFour(globalData);

}

function roseChart(data){
var rose = Chart.rose(),
        height = 400,
        format = d3.timeParse('%m/%Y'),
        causes = ['disease', 'wounds', 'other'],
        labels = ['A', 'B', 'C', 'D'];


      // Load the JSON data:
      d3.json('data.json', function( data ) {
        // Data from: http://ocp.hul.harvard.edu/dl/contagion/010164675

        // Format the date and rework the data:
        var scalar;
        data.forEach( function(d,i) { 
          d.date = format(d.date);
          d.label = labels[i];
          
          // Calculate the average annual mortality, as done by Nightingale:
          // http://understandinguncertainty.org/node/214 
          scalar = 10000*12 / d.army_size;
          d.disease = d.disease * scalar;
          d.wounds  = d.wounds  * scalar;
          d.other   = d.other   * scalar;
        } );
console.log(data);
        // Get the maximum value:
        var maxVal = d3.max( data, function(d) {
          return d3.max( [d.disease, d.wounds, d.other] );
        });

        // Where the maximum value gives us the maximum radius:
        var maxRadius = Math.sqrt(maxVal*12 / Math.PI);

        // Divide the dataset in two:
        // var dataset2 = data.slice(12,24),
          // dataset1 = data.slice(0,12);
        
        // Append a new figure to the DOM:
        figure = d3.select( 'body' )
          .append( 'figure' );

        // Get the figure width:
        width = 600;

        // Update the chart generator settings:
        rose.legend( causes )
          .width( width )
          .height( height )
          .delay( 0 )
          .duration( 500 )
          .domain( [0, maxRadius] )
          .angle( function(d,i) {  console.log(d); return i; } )
          .area( function(d, i) { return [d.disease]; } );             

        // Bind the data and generate a new chart:
        figure.datum( data )
          .attr('class', 'chart figure1')
          .call( rose );  

        // Append a new figure to the DOM:
        figure = d3.select( 'body' )
          .append( 'figure' );

        // Get the figure width:
        width = 600;

        // Update the chart generator settings:
        rose.width( width )
          .delay( 100 );       
      }); 

}

// Read in .csv data and make graph
d3.csv("data.csv", function(error, data) {
 
  // var parseDate = d3.time.format("%Y-%m-%d");;
  // var format = d3.time.format("%Y-%m-%d");
   var i = 2;
         data.forEach(function(d) {
                   d.col1 = +d["P53KO-O1"];
                   d.col2 = +d["p53KO-O2"];
                   d.avgP53 = (d.col1+d.col2)/2;
                   d.col3 = +d["p53KO-O-CAS1"];
                   d.col4 = +d["p53KO-O-CAS2"];
                   d.avgCAS = (d.col3+d.col4)/2;
                   d.col5 = +d["p53KO-O-RAS1"];
                   d.col6 = +d["p53KO-O-RAS2"];
                   d.avgRAS = (d.col5+d.col6)/2;
                   d.col7 = +d["WT-O1"];
                   d.col8 = +d["WT-O2"];
                   d.avgWT = (d.col7+d.col8)/2;
                   d.id = i++;
       });
  console.log(data);
           
             chartOne(data);
             chartTwo(data);
             chartThree(data);
             chartFour(data);
             globalData = data;
             roseChart(data);
   
}); 
    </script>
    <div class="charts">
        <div id="column1" class="graph">
          <h3>P53KO</h3>
          <button style="margin-left: 10px;" onclick="updateChartsAscending()">Ascending</button>
           <button onclick="updateChartsDescending()">Descending</button>
           <button onclick="updateChartsReset()">Reset</button>
        </div>
        <div id="column3" class="graph">
          <h3>p53KO-O-CAS</h3>
        </div>
         <div id="column5" class="graph">
            <h3>p53KO-O-RAS</h3>
         </div>
         <div id="chart4" class="graph">
            <h3>WT</h3>
         </div>
         <div id="roseChart"></div>
    </div>
    <div class="network" id="container">
    </div>


    <div id="multi-plane-representation" style="margin-left: 620px;">

    </div>

    <script src="js/lodash.js"></script>

    <script src="js/fisheye.js"></script>

    <script src="scripts/util.js"></script>
    <script src="scripts/genomics.js"></script>
    <script src="scripts/tooltip.js"></script>
    <script src="scripts/stacking.js"></script>
    <script src="scripts/TimeArcsViz.js"></script>
    <script src="scripts/TimeArcsPublications.js"></script>
    <script src="scripts/matrix.js"></script>
    <script src="scripts/sliderRelationship.js"></script>
    <script src="scripts/streamGraph.js"></script>


    <script src="scripts/forceDirected.js"></script>
    <script src="scripts/cluster.network.js"></script>


    <script src="scripts/jLouvain.js"></script>
    <script src="scripts/context.networks.js"></script>


    <script src="scripts/main.js"></script>


    <script type='text/javascript' src="js/jquery-ui.1.11.0.min.js"> </script>
    <link href="styles/jquery-ui.css" rel="stylesheet" type="text/css" />

    <script src="scripts/searchBox.js"></script>

  </body>
</html>